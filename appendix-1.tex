\clearpage
\makeatletter
\efloat@restorefloats
\makeatother


\begin{appendix}
\section{}
\singlespacing

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{### Model code for simulation 1}

\CommentTok{## create contingency task trials}

\NormalTok{create_trials <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(A, B, C, D, vector_length, }\DataTypeTok{shuffle=}\OtherTok{FALSE}\NormalTok{)\{}
  
\NormalTok{  event_frequencies <-}\StringTok{ }\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{2}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{4}\NormalTok{), }\DataTypeTok{times =} \KeywordTok{c}\NormalTok{(A,B,C,D))}
  
\NormalTok{  event_pairs <-}\StringTok{ }\KeywordTok{matrix}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{each =}\NormalTok{ vector_length),}
                          \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{each =}\NormalTok{ vector_length),}
                          \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{each =}\NormalTok{ vector_length),}
                          \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{), }\DataTypeTok{each =}\NormalTok{ vector_length)),}
                      \DataTypeTok{ncol=}\NormalTok{ vector_length}\OperatorTok{*}\DecValTok{3}\NormalTok{,}
                      \DataTypeTok{byrow=}\OtherTok{TRUE}\NormalTok{)}
  
\NormalTok{  event_matrix <-}\StringTok{ }\NormalTok{event_pairs[event_frequencies,]}
  
  \ControlFlowTok{if}\NormalTok{(shuffle}\OperatorTok{==}\OtherTok{FALSE}\NormalTok{) \{}\KeywordTok{return}\NormalTok{(event_matrix)}
\NormalTok{    \}}\ControlFlowTok{else}\NormalTok{\{}
    \KeywordTok{return}\NormalTok{(event_matrix[}\KeywordTok{sample}\NormalTok{(}\DecValTok{1}\OperatorTok{:}\KeywordTok{length}\NormalTok{(event_frequencies)),])}
\NormalTok{    \}}
  
\NormalTok{\}}

\CommentTok{## Run the model function}

\NormalTok{run_model <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(trials,probe)\{}
\NormalTok{  memory <-}\StringTok{ }\NormalTok{trials}

\CommentTok{#probe memory with cue only}

\NormalTok{  similarities <-}\StringTok{ }\KeywordTok{c}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{dim}\NormalTok{(memory)[}\DecValTok{1}\NormalTok{])\{}
\NormalTok{    similarities[i] <-}\StringTok{ }\NormalTok{lsa}\OperatorTok{::}\KeywordTok{cosine}\NormalTok{(probe,memory[i,])}
\NormalTok{  \}}
\NormalTok{  similarities[}\KeywordTok{is.nan}\NormalTok{(similarities)]<-}\DecValTok{0}
  
  \CommentTok{# generate echo}
\NormalTok{  weighted_memory <-}\StringTok{ }\NormalTok{memory}\OperatorTok{*}\NormalTok{(similarities}\OperatorTok{^}\DecValTok{3}\NormalTok{)}
\NormalTok{  echo <-}\StringTok{ }\KeywordTok{colSums}\NormalTok{(weighted_memory)}
  
  \KeywordTok{return}\NormalTok{(echo)}
\NormalTok{\}}

\CommentTok{### DEFINE conditions}

\NormalTok{conditions <-}\StringTok{ }\KeywordTok{list}\NormalTok{(}\KeywordTok{list}\NormalTok{(}\DataTypeTok{outcome_density =} \FloatTok{.2}\NormalTok{,}
                        \DataTypeTok{delta_p =} \DecValTok{0}\NormalTok{,}
                        \DataTypeTok{frequencies =} \KeywordTok{c}\NormalTok{(}\DecValTok{6}\NormalTok{,}\DecValTok{24}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{24}\NormalTok{)),}
                   \KeywordTok{list}\NormalTok{(}\DataTypeTok{outcome_density =} \FloatTok{.8}\NormalTok{,}
                        \DataTypeTok{delta_p =} \DecValTok{0}\NormalTok{,}
                        \DataTypeTok{frequencies =} \KeywordTok{c}\NormalTok{(}\DecValTok{24}\NormalTok{,}\DecValTok{6}\NormalTok{,}\DecValTok{24}\NormalTok{,}\DecValTok{6}\NormalTok{)),}
                   \KeywordTok{list}\NormalTok{(}\DataTypeTok{outcome_density =} \FloatTok{.33}\NormalTok{,}
                        \DataTypeTok{delta_p =} \FloatTok{.467}\NormalTok{,}
                        \DataTypeTok{frequencies =} \KeywordTok{c}\NormalTok{(}\DecValTok{17}\NormalTok{,}\DecValTok{13}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{27}\NormalTok{)),}
                   \KeywordTok{list}\NormalTok{(}\DataTypeTok{outcome_density =} \FloatTok{.67}\NormalTok{,}
                        \DataTypeTok{delta_p =} \FloatTok{.467}\NormalTok{,}
                        \DataTypeTok{frequencies =} \KeywordTok{c}\NormalTok{(}\DecValTok{27}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{13}\NormalTok{,}\DecValTok{17}\NormalTok{))}
\NormalTok{                   )}

\NormalTok{model_data<-}\KeywordTok{data.frame}\NormalTok{() }\CommentTok{#initialize data frame}

\CommentTok{## Run the model across conditions}

\ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{  trials <-}\StringTok{ }\KeywordTok{create_trials}\NormalTok{(}\DataTypeTok{A=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{1}\NormalTok{],}
                          \DataTypeTok{B=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{2}\NormalTok{],}
                          \DataTypeTok{C=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{3}\NormalTok{],}
                          \DataTypeTok{D=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{4}\NormalTok{],}
                          \DataTypeTok{vector_length =} \DecValTok{10}\NormalTok{,}
                          \DataTypeTok{shuffle=}\OtherTok{TRUE}\NormalTok{)}
\NormalTok{  model_output <-}\StringTok{ }\KeywordTok{run_model}\NormalTok{(}\DataTypeTok{trials=}\NormalTok{trials,}\DataTypeTok{probe =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{each=}\DecValTok{10}\NormalTok{))}
\NormalTok{  sim_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{outcome_density =}\NormalTok{ conditions[[i]]}\OperatorTok{$}\NormalTok{outcome_density,}
                         \DataTypeTok{delta_p =}\NormalTok{ conditions[[i]]}\OperatorTok{$}\NormalTok{delta_p,}
                         \DataTypeTok{expectation =}\NormalTok{ model_output[}\DecValTok{11}\NormalTok{])}
\NormalTok{  model_data <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(model_data,sim_data)}
\NormalTok{\}}

\CommentTok{# print table}
\CommentTok{#knitr::kable(model_data)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# plot}
\KeywordTok{library}\NormalTok{(ggplot2)}

\KeywordTok{ggplot}\NormalTok{(model_data,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{outcome_density,}
                      \DataTypeTok{y=}\NormalTok{expectation,}
                      \DataTypeTok{group=}\NormalTok{delta_p,}
                      \DataTypeTok{color=}\NormalTok{delta_p))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\newpage

\singlespacing

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{## Simulation 2}

\NormalTok{run_model_activations <-}\StringTok{ }\ControlFlowTok{function}\NormalTok{(trials,probe,resonance)\{}
\NormalTok{  memory <-}\StringTok{ }\NormalTok{trials}

\CommentTok{#probe memory with cue only}

\NormalTok{  similarities <-}\StringTok{ }\KeywordTok{c}\NormalTok{()}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\KeywordTok{dim}\NormalTok{(memory)[}\DecValTok{1}\NormalTok{])\{}
\NormalTok{    similarities[i] <-}\StringTok{ }\NormalTok{lsa}\OperatorTok{::}\KeywordTok{cosine}\NormalTok{(probe,memory[i,])}
\NormalTok{  \}}
\NormalTok{  similarities[}\KeywordTok{is.nan}\NormalTok{(similarities)] <-}\StringTok{ }\DecValTok{0}

  \CommentTok{# get activations}
\NormalTok{  activations <-}\StringTok{ }\KeywordTok{sum}\NormalTok{(similarities}\OperatorTok{^}\NormalTok{resonance)}

  \KeywordTok{return}\NormalTok{(activations)}
\NormalTok{\}}

\CommentTok{# frequency judgment simulation}
\NormalTok{freq_model_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{() }\CommentTok{#initialize data frame}

\CommentTok{## Run the model across conditions}

\ControlFlowTok{for}\NormalTok{(tau }\ControlFlowTok{in} \KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{3}\NormalTok{,}\DecValTok{9}\NormalTok{,}\DecValTok{15}\NormalTok{,}\DecValTok{21}\NormalTok{,}\DecValTok{27}\NormalTok{))\{}
  \ControlFlowTok{for}\NormalTok{(i }\ControlFlowTok{in} \DecValTok{1}\OperatorTok{:}\DecValTok{4}\NormalTok{)\{}
\NormalTok{    trials <-}\StringTok{ }\KeywordTok{create_trials}\NormalTok{(}\DataTypeTok{A=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{1}\NormalTok{],}
                            \DataTypeTok{B=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{2}\NormalTok{],}
                            \DataTypeTok{C=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{3}\NormalTok{],}
                            \DataTypeTok{D=}\NormalTok{conditions[[i]]}\OperatorTok{$}\NormalTok{frequencies[}\DecValTok{4}\NormalTok{],}
                            \DataTypeTok{vector_length =} \DecValTok{10}\NormalTok{,}
                            \DataTypeTok{shuffle=}\OtherTok{TRUE}\NormalTok{)}
    
\NormalTok{    freq_A <-}\StringTok{ }\KeywordTok{run_model_activations}\NormalTok{(}\DataTypeTok{trials=}\NormalTok{trials,}
                                    \DataTypeTok{probe =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{each=}\DecValTok{10}\NormalTok{),}
                                    \DataTypeTok{resonance =}\NormalTok{ tau)}
\NormalTok{    freq_B <-}\StringTok{ }\KeywordTok{run_model_activations}\NormalTok{(}\DataTypeTok{trials=}\NormalTok{trials,}
                                    \DataTypeTok{probe =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{1}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{each=}\DecValTok{10}\NormalTok{),}
                                    \DataTypeTok{resonance =}\NormalTok{ tau)}
\NormalTok{    freq_C <-}\StringTok{ }\KeywordTok{run_model_activations}\NormalTok{(}\DataTypeTok{trials=}\NormalTok{trials,}
                                    \DataTypeTok{probe =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{each=}\DecValTok{10}\NormalTok{),}
                                    \DataTypeTok{resonance =}\NormalTok{ tau)}
\NormalTok{    freq_D <-}\StringTok{ }\KeywordTok{run_model_activations}\NormalTok{(}\DataTypeTok{trials=}\NormalTok{trials,}
                                    \DataTypeTok{probe =} \KeywordTok{rep}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{),}\DataTypeTok{each=}\DecValTok{10}\NormalTok{),}
                                    \DataTypeTok{resonance =}\NormalTok{ tau)}
    
\NormalTok{    sim_data <-}\StringTok{ }\KeywordTok{data.frame}\NormalTok{(}\DataTypeTok{outcome_density =}\NormalTok{ conditions[[i]]}\OperatorTok{$}\NormalTok{outcome_density,}
                           \DataTypeTok{delta_p =}\NormalTok{ conditions[[i]]}\OperatorTok{$}\NormalTok{delta_p,}
                           \DataTypeTok{expectation =}\NormalTok{ (freq_A}\OperatorTok{/}\NormalTok{(freq_A}\OperatorTok{+}\NormalTok{freq_B)) }\OperatorTok{-}\StringTok{ }\NormalTok{(freq_C}\OperatorTok{/}\NormalTok{(freq_C}\OperatorTok{+}\NormalTok{freq_D)),}
                           \DataTypeTok{resonance =}\NormalTok{ tau)}
    
\NormalTok{    freq_model_data <-}\StringTok{ }\KeywordTok{rbind}\NormalTok{(freq_model_data,sim_data)}
\NormalTok{  \}}
\NormalTok{\}}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# plot}
\KeywordTok{library}\NormalTok{(latex2exp)}
\NormalTok{freq_model_data}\OperatorTok{$}\NormalTok{delta_p <-}\StringTok{ }\KeywordTok{as.factor}\NormalTok{(freq_model_data}\OperatorTok{$}\NormalTok{delta_p)}

\KeywordTok{ggplot}\NormalTok{(freq_model_data,}\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x=}\NormalTok{outcome_density,}
                      \DataTypeTok{y=}\NormalTok{expectation,}
                      \DataTypeTok{group=}\NormalTok{delta_p,}
                      \DataTypeTok{color=}\NormalTok{delta_p,}
                      \DataTypeTok{shape=}\NormalTok{delta_p))}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_line}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\StringTok{"Probability of Outcome"}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\KeywordTok{TeX}\NormalTok{(r}\StringTok{'(Simulated $\textbackslash{}Delta$P)'}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{coord_cartesian}\NormalTok{(}\DataTypeTok{xlim=}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{1}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_color_discrete}\NormalTok{(}\DataTypeTok{name =} \KeywordTok{expression}\NormalTok{(Delta}\OperatorTok{~}\NormalTok{P))}\OperatorTok{+}
\StringTok{  }\KeywordTok{scale_shape_discrete}\NormalTok{(}\DataTypeTok{name =} \KeywordTok{expression}\NormalTok{(Delta}\OperatorTok{~}\NormalTok{P))}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_classic}\NormalTok{(}\DataTypeTok{base_size=}\DecValTok{12}\NormalTok{)}\OperatorTok{+}
\StringTok{  }\KeywordTok{facet_wrap}\NormalTok{(}\OperatorTok{~}\NormalTok{resonance)}
\end{Highlighting}
\end{Shaded}

\end{appendix}
